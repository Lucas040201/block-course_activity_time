/**
 * Languages configuration for the block_course_activity_time plugin.
 *
 * @package   block_course_activity_time
 * @copyright 2024, Lucas Mendes {@link https://www.lucasmendesdev.com.br}
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */ define(["jquery","core/templates","core/str","block_course_activity_time/repository","block_course_activity_time/modal",],function(t,e,i,a){let s={NOT_FOUND:"block_course_activity_time/components/students_progress/row_not_found_students",EMPTY:"block_course_activity_time/components/students_progress/row_empty_students",STUDENTS:"block_course_activity_time/components/students_progress/row_students"};async function o(t,o=!1){let c=r(t),d=await a.getStudents(c),l=s.STUDENTS;o||d.users.length||c.search||(l=s.EMPTY),o||d.users.length||!c.search||(n(t,"see_more"),l=s.NOT_FOUND),o||t.find(".course-activity-time-table-body").empty();let u=await i.get_string("hour_label","block_course_activity_time"),m=await i.get_string("hours_label","block_course_activity_time");d.users=d.users.map(t=>(0===Number(t.totaltime)?t.totaltime="-":t.totaltime=t.totaltime>1?`${t.totaltime} ${m}`:`${t.totaltime} ${u}`,t));let f=await e.render(l,{users:d.users,courseid:c.courseid});t.find(".total_students").text(d.total),t.find(".course-activity-time-table-body").append(f);let y=t.find(".students-item").length;d.total===y?n(t):t.find(".see_more").hasClass("hidden")&&d.total>y&&function t(e,i="see_more"){e.find(`.${i}`).removeClass("hidden"),e.find(`.${i}`).attr("disabled",!1)}(t)}function n(t,e="see_more"){t.find(`.${e}`).addClass("hidden"),t.find(`.${e}`).attr("disabled",!0)}function r(t){return{courseid:Number(t.attr("data-courseid")),limit:Number(t.attr("data-limit")),page:Number(t.attr("data-page")),search:t.find("#search").val()||"",from:t.find("#from").val()||"",to:t.find("#to").val()||""}}async function c(e){await o(e=t(e)),function t(e){e.find(".see_more").on("click",async function(){let t=Number(e.attr("data-page"))+1;e.attr("data-page",t),await o(e,r(e),!0)})}(e);let i;e.find("#search").on("keyup",t=>{clearTimeout(i),i=setTimeout(()=>{o(e)},2e3)}),e.find('[name="from"]').on("change",t=>{o(e)}),e.find('[name="to"]').on("change",t=>{o(e)})}return{init:c}});